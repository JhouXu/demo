<!DOCTYPE html>
<html lang="cn-ZN">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>授权页</title>
  </head>
  <body>
    <div class="container">
      <a class="a">点击进行微信授权</a>
    </div>
  </body>
  <script src="https://cdn.bootcdn.net/ajax/libs/vConsole/3.14.6/vconsole.min.js"></script>
  <script>
    // new VConsole();
  </script>
  <script src="https://cdn.bootcdn.net/ajax/libs/axios/0.27.2/axios.min.js"></script>
  <script>
    const appid = "wx05f6522d1205b5f9";
    const secret = "ede2a554c625b641160301f39fa5f49e";

    const redirect_uri = "http%3A%2F%2F192.168.1.167%3A5500%2Fwx%2Fuser.html"; // urlencode http://127.0.0.1:5500/wx/user.html
    const scope = "snsapi_userinfo";
    const state = "true";

    // 重定向到 redirect_uri 地址
    const getCode = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=${appid}&redirect_uri=${redirect_uri}&response_type=code&scope=${scope}&state=${state}#wechat_redirect`;
    document.querySelector(".a").setAttribute("href", getCode);

    const getAccessToken = `https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=${appid}&secret=${secret}`;
    fetch(getAccessToken, {
      methods: "get",
      mode: "no-cors",
    })
      .then((response) => {
        return response.json();
      })
      .then((res) => {
        console.log(res);
      });
  </script>
</html>
