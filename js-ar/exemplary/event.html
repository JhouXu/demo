<!DOCTYPE html>
<html lang="zn-CN">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>A-frame</title>

    <!-- a-frame 渲染引擎 -->
    <!-- <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script> -->
    <!-- a-frame 附加组件 - 包含动画播放 -->
    <!-- <script src="https://unpkg.com/aframe-extras@3.3.0/dist/aframe-extras.min.js"></script> -->

    <!-- a-frame 官方使用插件 -->
    <!-- <script src="https://aframe.io/aframe/dist/aframe-master.min.js"></script> -->
    <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
    <!-- <script src="https://unpkg.com/aframe-environment-component@1.3.0/dist/aframe-environment-component.min.js"></script> -->

    <script>
      AFRAME.registerComponent("event", {
        init: function () {
          const itemEls = (this.itemEls = this.el.querySelectorAll(".item"));
          this.onClick = this.onClick.bind(this);
          this.onMouseenter = this.onMouseenter.bind(this);

          console.log(itemEls);
          // for (let item of itemEls) {
          //   item.addEventListener("click", this.onClick);
          //   item.addEventListener("click", this.onMouseenter);
          // }
          for (var i = 0; i < itemEls.length; ++i) {
            itemEls[i].addEventListener("mouseenter", this.onMouseEnter);
            itemEls[i].addEventListener("click", this.onClick);
          }
        },

        onClick: function (evt) {
          console.log(evt);
        },

        onMouseenter: function (evt) {
          console.log(evt);
        },
      });

      AFRAME.registerComponent("change-color-on-hover", {
        schema: {
          color: { default: "red" },
        },

        init: function () {
          var data = this.data;
          var el = this.el; // <a-box>
          var defaultColor = el.getAttribute("material").color;

          el.addEventListener("mouseenter", function () {
            el.setAttribute("color", data.color);
          });

          el.addEventListener("mouseleave", function () {
            el.setAttribute("color", defaultColor);
          });
        },
      });
    </script>
  </head>
  <body>
    <!-- 创建场景 -->
    <!-- renderer="colorManagement: true;" -->
    <a-scene environment>
      <!-- 资源加载 -->
      <a-assets timeout="30000">
        <a-assets-item id="robot" src="../glb/BrainStem.glb"></a-assets-item>
        <a-assets-item id="ship" src="../glb/ship.glb"></a-assets-item>
      </a-assets>

      <!-- 实体渲染 -->
      <a-entity id="menu" event>
        <a-box id="tomato" class="item tomato" color="tomato" position="0 1 -3" rotation="45 0 0"></a-box>
        <a-box id="purple" class="item purple" color="purple" position="-1 1 -3" rotation="0 45 0"></a-box>
        <a-box
          id="blue"
          class="item blue"
          color="blue"
          position="0 1 1"
          rotation="0 0 0"
          change-color-on-hover="yellow"
        >
        </a-box>
      </a-entity>

      <a-sky color="#222"></a-sky>
      <a-entity camera active="true" position="0 3 6"></a-entity>

      <a-camera position="0 3 6">
        <a-cursor color="#4CC3D9" fuse="true" timeout="10"></a-cursor>
      </a-camera>
      <!-- <a-camera> <a-cursor> </a-cursor> </a-camera> -->
      <!-- <a-entity
        position="0 3 6"
        camera
        look-controls="magicWindowTrackingEnabled: false; touchEnabled: false; mouseEnabled: false"
      >
        <a-entity
          id="fadeBackground"
          geometry="primitive: sphere; radius: 2.5"
          material="color: black; side: back; shader: flat; transparent: true; opacity: 0.6"
          visible="false"
        >
        </a-entity>
      </a-entity> -->

      <!-- <a-entity
        id="background"
        position="0 0 0"
        geometry="primitive: sphere; radius: 2.0"
        material="color: red; side: back; shader: flat"
        scale="0.001 0.001 0.001"
        visible="false"
        class="raycastable"
      >
      </a-entity> -->
    </a-scene>
  </body>
  <script src="https://cdn.bootcdn.net/ajax/libs/vConsole/3.14.7/vconsole.min.js"></script>
  <script>
    // new VConsole();
  </script>
</html>
